<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üõãÔ∏è WebXR AR v2 | AR –ú–µ–±–µ–ª—å</title>
    <meta http-equiv="cache-control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="0">
    
    <!-- WebXR Meta -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <!-- Three.js ES –º–æ–¥—É–ª–∏ -->
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.168.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.168.0/examples/jsm/"
            }
        }
    </script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            text-align: center;
            max-width: 400px;
            background: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        h1 {
            font-size: 24px;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .subtitle {
            font-size: 14px;
            opacity: 0.8;
            margin-bottom: 30px;
        }
        
        .start-btn {
            background: linear-gradient(45deg, #FF6B35, #F7931E);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 8px 20px rgba(255, 107, 53, 0.3);
            margin-bottom: 20px;
            width: 100%;
        }
        
        .start-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 25px rgba(255, 107, 53, 0.4);
        }
        
        .start-btn:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
        }
        
        .debug-info {
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            font-size: 12px;
            text-align: left;
            display: none;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .features {
            list-style: none;
            margin-top: 20px;
        }
        
        .features li {
            padding: 8px 0;
            font-size: 14px;
            opacity: 0.9;
        }
        
        .features li:before {
            content: "‚ö° ";
            color: #FF6B35;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ WebXR AR v2.0</h1>
        <p class="subtitle">–£–ª—É—á—à–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è —Å –º–æ–¥—É–ª—è–º–∏ ES<br>–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ—à–∏–±–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏!</p>
        
        <button id="start-ar-btn" class="start-btn" onclick="startWebXRAR()">
            üöÄ –ó–ê–ü–£–°–¢–ò–¢–¨ WebXR AR v2
        </button>
        
        <ul class="features">
            <li>üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ GLTFLoader</li>
            <li>‚ö° –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ ES –º–æ–¥—É–ª–∏</li>
            <li>üéØ –†–µ–∞–ª—å–Ω–æ–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ –Ω–∞ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—è—Ö</li>
            <li>üëÜ –ö–∞—Å–∞–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞ –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è</li>
            <li>üîÑ –°–º–µ–Ω–∞ –º–æ–¥–µ–ª–µ–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏</li>
            <li>üóëÔ∏è –û—á–∏—Å—Ç–∫–∞ —Ä–∞–∑–º–µ—â–µ–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤</li>
        </ul>
        
        <div id="debug-info" class="debug-info"></div>
    </div>

    <script type="module">
        import * as THREE from 'three';
        import { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js';
        
        // –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∫–Ω–æ–ø–∫–∏
        window.startWebXRAR = async function() {
            const btn = document.getElementById('start-ar-btn');
            const debugInfo = document.getElementById('debug-info');
            
            btn.innerHTML = 'üöÄ –ó–ê–ü–£–°–ö WebXR AR v2...';
            btn.disabled = true;
            btn.style.background = '#666';
            
            debugInfo.style.display = 'block';
            debugInfo.innerHTML = 'üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ WebXR –ø–æ–¥–¥–µ—Ä–∂–∫–∏...';
            
            try {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É WebXR
                if (!navigator.xr) {
                    throw new Error('WebXR –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤ —ç—Ç–æ–º –±—Ä–∞—É–∑–µ—Ä–µ');
                }
                
                debugInfo.innerHTML += '<br>‚úÖ WebXR –Ω–∞–π–¥–µ–Ω! –ü—Ä–æ–≤–µ—Ä—è–µ–º AR...';
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É immersive-ar
                const supported = await navigator.xr.isSessionSupported('immersive-ar');
                if (!supported) {
                    throw new Error('AR —Ä–µ–∂–∏–º –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –Ω–∞ —ç—Ç–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ');
                }
                
                debugInfo.innerHTML += '<br>‚úÖ AR –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è! –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —Å–µ—Å—Å–∏—é...';
                
                // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º AR —Å–µ—Å—Å–∏—é —Å hit-test
                const session = await navigator.xr.requestSession('immersive-ar', {
                    requiredFeatures: ['local', 'hit-test']
                });
                
                debugInfo.innerHTML += '<br>‚úÖ AR —Å–µ—Å—Å–∏—è —Å–æ–∑–¥–∞–Ω–∞! –ù–∞—Å—Ç—Ä–æ–π–∫–∞ WebGL...';
                
                // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º WebGL –∫–æ–Ω—Ç–µ–∫—Å—Ç
                const canvas = document.createElement('canvas');
                const gl = canvas.getContext('webgl', { xrCompatible: true });
                
                await session.updateRenderState({
                    baseLayer: new XRWebGLLayer(session, gl)
                });
                
                debugInfo.innerHTML += '<br>‚úÖ WebGL –Ω–∞—Å—Ç—Ä–æ–µ–Ω! –°–æ–∑–¥–∞–µ–º —Å—Ü–µ–Ω—É...';
                
                // Three.js —Å—Ü–µ–Ω–∞ –¥–ª—è WebXR
                const scene = new THREE.Scene();
                const camera = new THREE.PerspectiveCamera();
                const renderer = new THREE.WebGLRenderer({ 
                    canvas: canvas, 
                    context: gl,
                    alpha: true, 
                    antialias: true 
                });
                renderer.xr.enabled = true;
                renderer.xr.setSession(session);
                
                // –û—Å–≤–µ—â–µ–Ω–∏–µ
                const ambientLight = new THREE.AmbientLight(0xffffff, 0.4);
                scene.add(ambientLight);
                const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
                directionalLight.position.set(1, 4, 2);
                directionalLight.castShadow = true;
                scene.add(directionalLight);
                
                // –†–µticle –¥–ª—è –ø–æ–∫–∞–∑–∞ —Ç–æ—á–∫–∏ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è
                const reticleGeometry = new THREE.RingGeometry(0.15, 0.2, 32).rotateX(-Math.PI / 2);
                const reticleMaterial = new THREE.MeshBasicMaterial({ color: 0xffffff });
                const reticle = new THREE.Mesh(reticleGeometry, reticleMaterial);
                reticle.matrixAutoUpdate = false;
                reticle.visible = false;
                scene.add(reticle);
                
                debugInfo.innerHTML += '<br>‚úÖ –°—Ü–µ–Ω–∞ –≥–æ—Ç–æ–≤–∞! –ù–∞—Å—Ç—Ä–æ–π–∫–∞ hit testing...';
                
                // Hit test setup
                let hitTestSource = null;
                let hitTestSourceRequested = false;
                let referenceSpace = null;
                
                // –ú–∞—Å—Å–∏–≤ —Ä–∞–∑–º–µ—â–µ–Ω–Ω—ã—Ö –¥–∏–≤–∞–Ω–æ–≤
                const placedFurniture = [];
                
                // –ó–∞–≥—Ä—É–∑—á–∏–∫ –º–æ–¥–µ–ª–µ–π ES –º–æ–¥—É–ª—å
                const loader = new GLTFLoader();
                let currentModel = 'cannoli';
                let furnitureTemplate = null;
                
                debugInfo.innerHTML += '<br>‚úÖ GLTFLoader —Å–æ–∑–¥–∞–Ω —É—Å–ø–µ—à–Ω–æ!';
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –º–æ–¥–µ–ª—å –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è
                function loadFurnitureModel(modelName) {
                    debugInfo.innerHTML += `<br>üì¶ –ó–∞–≥—Ä—É–∂–∞–µ–º –º–æ–¥–µ–ª—å ${modelName}...`;
                    
                    loader.load(`/models/${modelName}-sofa.glb`, function(gltf) {
                        furnitureTemplate = gltf.scene.clone();
                        furnitureTemplate.scale.set(0.3, 0.3, 0.3);
                        
                        // –£–ª—É—á—à–∞–µ–º –º–∞—Ç–µ—Ä–∏–∞–ª—ã
                        furnitureTemplate.traverse(function(child) {
                            if (child.isMesh) {
                                child.castShadow = true;
                                child.receiveShadow = true;
                                if (child.material) {
                                    child.material.metalness = 0.1;
                                    child.material.roughness = 0.8;
                                }
                            }
                        });
                        
                        debugInfo.innerHTML += `<br>‚úÖ –ú–æ–¥–µ–ª—å ${modelName} –∑–∞–≥—Ä—É–∂–µ–Ω–∞!`;
                        console.log(`üõãÔ∏è –ú–æ–¥–µ–ª—å ${modelName} –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–∑–º–µ—â–µ–Ω–∏—é`);
                    }, function(progress) {
                        const percent = Math.round((progress.loaded / progress.total) * 100);
                        debugInfo.innerHTML = debugInfo.innerHTML.replace(/üì¶ –ó–∞–≥—Ä—É–∂–∞–µ–º –º–æ–¥–µ–ª—å.*/, `üì¶ –ó–∞–≥—Ä—É–∂–∞–µ–º –º–æ–¥–µ–ª—å ${modelName}... ${percent}%`);
                    }, function(error) {
                        console.error(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏ ${modelName}:`, error);
                        debugInfo.innerHTML += `<br>‚ö†Ô∏è –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ ${modelName}, —Å–æ–∑–¥–∞–µ–º –ø—Ä–æ—Å—Ç—É—é –º–æ–¥–µ–ª—å`;
                        createFallbackModel(modelName);
                    });
                }
                
                // –§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ—Å—Ç–æ–π –º–æ–¥–µ–ª–∏
                function createFallbackModel(modelName) {
                    const geometry = new THREE.BoxGeometry(0.6, 0.3, 0.3);
                    const color = modelName === 'cannoli' ? 0x8B4513 : 0x654321;
                    const material = new THREE.MeshPhongMaterial({ color: color });
                    furnitureTemplate = new THREE.Mesh(geometry, material);
                    furnitureTemplate.castShadow = true;
                    console.log(`üîß –°–æ–∑–¥–∞–Ω–∞ –ø—Ä–æ—Å—Ç–∞—è –º–æ–¥–µ–ª—å –¥–ª—è ${modelName}`);
                }
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—É—é –º–æ–¥–µ–ª—å
                loadFurnitureModel(currentModel);
                
                // –§—É–Ω–∫—Ü–∏—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –º–µ–±–µ–ª–∏
                function placeFurniture(matrix) {
                    if (!furnitureTemplate) {
                        console.log('‚ùå –ú–æ–¥–µ–ª—å –º–µ–±–µ–ª–∏ –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
                        return;
                    }
                    
                    const furniture = furnitureTemplate.clone();
                    furniture.matrix.fromArray(matrix);
                    furniture.matrixAutoUpdate = false;
                    
                    scene.add(furniture);
                    placedFurniture.push(furniture);
                    
                    console.log(`üõãÔ∏è –î–∏–≤–∞–Ω ${currentModel} —Ä–∞–∑–º–µ—â–µ–Ω! –í—Å–µ–≥–æ —Ä–∞–∑–º–µ—â–µ–Ω–æ: ${placedFurniture.length}`);
                }
                
                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–∞—Å–∞–Ω–∏—è —ç–∫—Ä–∞–Ω–∞ –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è
                session.addEventListener('select', (event) => {
                    if (reticle.visible) {
                        placeFurniture(reticle.matrix.elements);
                    } else {
                        console.log('‚ö†Ô∏è Reticle –Ω–µ –≤–∏–¥–µ–Ω - –Ω–∞–π–¥–∏—Ç–µ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å');
                    }
                });
                
                // –ü–æ–ª—É—á–∞–µ–º reference space
                session.requestReferenceSpace('local').then((refSpace) => {
                    referenceSpace = refSpace;
                    
                    // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º hit test source
                    session.requestReferenceSpace('viewer').then((viewerSpace) => {
                        session.requestHitTestSource({ space: viewerSpace }).then((source) => {
                            hitTestSource = source;
                            console.log('‚úÖ Hit test source —Å–æ–∑–¥–∞–Ω');
                            debugInfo.innerHTML += '<br>‚úÖ Hit test –Ω–∞—Å—Ç—Ä–æ–µ–Ω!';
                        });
                    });
                });
                
                // –§—Ä–µ–π–º –ª—É–ø–∞
                function onXRFrame(time, frame) {
                    session.requestAnimationFrame(onXRFrame);
                    
                    // Hit testing
                    if (hitTestSource && referenceSpace) {
                        const hitTestResults = frame.getHitTestResults(hitTestSource);
                        
                        if (hitTestResults.length > 0) {
                            const hit = hitTestResults[0];
                            const pose = hit.getPose(referenceSpace);
                            
                            if (pose) {
                                reticle.visible = true;
                                reticle.matrix.fromArray(pose.transform.matrix);
                            }
                        } else {
                            reticle.visible = false;
                        }
                    }
                    
                    renderer.render(scene, camera);
                }
                
                session.requestAnimationFrame(onXRFrame);
                
                // UI –∫–æ–Ω—Ç—Ä–æ–ª—ã
                const arControls = document.createElement('div');
                arControls.style.cssText = `
                    position: fixed;
                    bottom: 20px;
                    left: 50%;
                    transform: translateX(-50%);
                    z-index: 10000;
                    display: flex;
                    gap: 10px;
                    pointer-events: auto;
                `;
                
                // –ö–Ω–æ–ø–∫–∞ —Å–º–µ–Ω—ã –º–æ–¥–µ–ª–∏
                const modelBtn = document.createElement('button');
                modelBtn.innerHTML = `üõãÔ∏è ${currentModel.toUpperCase()}`;
                modelBtn.style.cssText = `
                    padding: 10px 15px;
                    background: #FF6B35;
                    color: white;
                    border: none;
                    border-radius: 8px;
                    font-size: 12px;
                    font-weight: bold;
                    cursor: pointer;
                `;
                
                modelBtn.onclick = () => {
                    currentModel = currentModel === 'cannoli' ? 'bellagio' : 'cannoli';
                    modelBtn.innerHTML = `üõãÔ∏è ${currentModel.toUpperCase()}`;
                    loadFurnitureModel(currentModel);
                    console.log(`üîÑ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–æ –Ω–∞ –º–æ–¥–µ–ª—å: ${currentModel}`);
                };
                
                // –ö–Ω–æ–ø–∫–∞ –æ—á–∏—Å—Ç–∫–∏
                const clearBtn = document.createElement('button');
                clearBtn.innerHTML = 'üóëÔ∏è –û–ß–ò–°–¢–ò–¢–¨';
                clearBtn.style.cssText = `
                    padding: 10px 15px;
                    background: #f44336;
                    color: white;
                    border: none;
                    border-radius: 8px;
                    font-size: 12px;
                    font-weight: bold;
                    cursor: pointer;
                `;
                
                clearBtn.onclick = () => {
                    placedFurniture.forEach(furniture => scene.remove(furniture));
                    placedFurniture.length = 0;
                    console.log('üóëÔ∏è –í—Å–µ –æ–±—ä–µ–∫—Ç—ã —É–¥–∞–ª–µ–Ω—ã');
                };
                
                // –ö–Ω–æ–ø–∫–∞ –≤—ã—Ö–æ–¥–∞
                const exitBtn = document.createElement('button');
                exitBtn.innerHTML = '‚ùå –í–´–•–û–î';
                exitBtn.style.cssText = `
                    padding: 10px 15px;
                    background: #9e9e9e;
                    color: white;
                    border: none;
                    border-radius: 8px;
                    font-size: 12px;
                    font-weight: bold;
                    cursor: pointer;
                `;
                
                exitBtn.onclick = () => {
                    session.end();
                };
                
                arControls.appendChild(modelBtn);
                arControls.appendChild(clearBtn);
                arControls.appendChild(exitBtn);
                document.body.appendChild(arControls);
                
                debugInfo.innerHTML += '<br>‚úÖ WebXR AR v2 –≥–æ—Ç–æ–≤! –î–≤–∏–≥–∞–π—Ç–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–µ–π...';
                debugInfo.innerHTML += '<br>üëÜ –ö–∞—Å–∞–π—Ç–µ—Å—å —ç–∫—Ä–∞–Ω–∞ –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –º–µ–±–µ–ª–∏';
                
                // –°–∫—Ä—ã–≤–∞–µ–º –¥–µ–±–∞–≥ –∏–Ω—Ñ–æ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
                setTimeout(() => {
                    debugInfo.style.display = 'none';
                }, 4000);
                
                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–µ—Å—Å–∏–∏
                session.addEventListener('end', () => {
                    if (document.body.contains(arControls)) {
                        document.body.removeChild(arControls);
                    }
                    debugInfo.style.display = 'none';
                    btn.innerHTML = 'üöÄ –ó–ê–ü–£–°–¢–ò–¢–¨ WebXR AR v2';
                    btn.disabled = false;
                    btn.style.background = 'linear-gradient(45deg, #FF6B35, #F7931E)';
                    console.log('üîö WebXR —Å–µ—Å—Å–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞');
                });
                
            } catch (error) {
                debugInfo.innerHTML += `<br>‚ùå –û–®–ò–ë–ö–ê: ${error.message}`;
                
                if (error.message.includes('–Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è')) {
                    debugInfo.innerHTML += '<br><br>üí° –ü–æ–ø—Ä–æ–±—É–π—Ç–µ:';
                    debugInfo.innerHTML += '<br>‚Ä¢ –û–±–Ω–æ–≤–∏—Ç—å Chrome/Edge –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏';
                    debugInfo.innerHTML += '<br>‚Ä¢ –í–∫–ª—é—á–∏—Ç—å chrome://flags/#webxr-ar-module';
                    debugInfo.innerHTML += '<br>‚Ä¢ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å AR-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ';
                }
                
                console.error('WebXR Error:', error);
                btn.innerHTML = 'üöÄ –ó–ê–ü–£–°–¢–ò–¢–¨ WebXR AR v2';
                btn.disabled = false;
                btn.style.background = 'linear-gradient(45deg, #FF6B35, #F7931E)';
            }
        };
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('load', async () => {
            const debugInfo = document.getElementById('debug-info');
            debugInfo.style.display = 'block';
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≥—Ä—É–∑–∫—É –º–æ–¥—É–ª–µ–π
            debugInfo.innerHTML = 'üîß –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥—É–ª–µ–π Three.js...';
            
            try {
                console.log('THREE –≤–µ—Ä—Å–∏—è:', THREE.REVISION);
                console.log('GLTFLoader:', GLTFLoader);
                debugInfo.innerHTML += '<br>‚úÖ Three.js –∑–∞–≥—Ä—É–∂–µ–Ω, –≤–µ—Ä—Å–∏—è: ' + THREE.REVISION;
                debugInfo.innerHTML += '<br>‚úÖ GLTFLoader –¥–æ—Å—Ç—É–ø–µ–Ω';
                
                if (navigator.xr) {
                    try {
                        const supported = await navigator.xr.isSessionSupported('immersive-ar');
                        if (supported) {
                            debugInfo.innerHTML += '<br>‚úÖ WebXR AR –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è!';
                        } else {
                            debugInfo.innerHTML += '<br>‚ö†Ô∏è WebXR –Ω–∞–π–¥–µ–Ω, –Ω–æ AR –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è';
                        }
                    } catch (e) {
                        debugInfo.innerHTML += '<br>‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ WebXR –ø–æ–¥–¥–µ—Ä–∂–∫–∏';
                    }
                } else {
                    debugInfo.innerHTML += '<br>‚ùå WebXR –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤ —ç—Ç–æ–º –±—Ä–∞—É–∑–µ—Ä–µ';
                }
            } catch (e) {
                debugInfo.innerHTML += '<br>‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥—É–ª–µ–π: ' + e.message;
                console.error('Module loading error:', e);
            }
            
            setTimeout(() => {
                debugInfo.style.display = 'none';
            }, 4000);
        });
    </script>
</body>
</html>