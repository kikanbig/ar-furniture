<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ü™ë –ü–†–û–°–¢–û–ï –ö–†–ï–°–õ–û AR –¢–ï–°–¢</title>
    
    <!-- WebXR Polyfill -->
    <script src="https://cdn.jsdelivr.net/npm/webxr-polyfill@latest/build/webxr-polyfill.min.js"></script>
    
    <!-- Three.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
    
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #000;
            color: white;
            margin: 0;
            padding: 20px;
        }
        
        .start-btn {
            background: linear-gradient(45deg, #FF6B6B, #FF8E53);
            color: white;
            border: none;
            padding: 20px 40px;
            font-size: 18px;
            font-weight: bold;
            border-radius: 15px;
            cursor: pointer;
            width: 100%;
            margin: 15px 0;
            box-shadow: 0 8px 20px rgba(255, 107, 107, 0.3);
        }
        
        .log {
            background: rgba(0,0,0,0.9);
            color: #FF6B6B;
            padding: 15px;
            border-radius: 10px;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
            margin: 10px 0;
            border: 2px solid #FF6B6B;
        }
        
        .hidden { display: none; }
        
        .success {
            background: linear-gradient(135deg, #FF6B6B 0%, #FF8E53 100%);
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            text-align: center;
            border: 2px solid #FF6B6B;
        }
    </style>
</head>
<body>
    <div class="success">
        <h1>ü™ë –ü–†–û–°–¢–û–ï –ö–†–ï–°–õ–û AR –¢–ï–°–¢</h1>
        <p>–≠—Ç–∞ –≤–µ—Ä—Å–∏—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¢–û–õ–¨–ö–û –æ–¥–Ω–æ –±–æ–ª—å—à–æ–µ —è—Ä–∫–æ–µ –∫—Ä–µ—Å–ª–æ</p>
        <p>–ö—Ä–µ—Å–ª–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤–∏–¥–Ω–æ –ø—Ä—è–º–æ –ø–µ—Ä–µ–¥ –≤–∞–º–∏!</p>
    </div>
    
    <button id="startBtn" class="start-btn">üöÄ –ó–ê–ü–£–°–¢–ò–¢–¨ –ü–†–û–°–¢–û–ï –ö–†–ï–°–õ–û</button>
    
    <div id="log" class="log">
        <div>üì± –ì–æ—Ç–æ–≤ –∫ –∑–∞–ø—É—Å–∫—É AR...</div>
    </div>
    
    <script>
        let session = null;
        let renderer = null;
        let scene = null;
        let camera = null;
        let chair = null;
        let frameCount = 0;
        
        const startBtn = document.getElementById('startBtn');
        const log = document.getElementById('log');
        
        function addLog(message) {
            const div = document.createElement('div');
            div.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            log.appendChild(div);
            log.scrollTop = log.scrollHeight;
        }
        
        startBtn.addEventListener('click', async () => {
            startBtn.disabled = true;
            startBtn.innerHTML = '‚è≥ –ó–∞–ø—É—Å–∫ AR...';
            
            addLog('üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ—Å—Ç–æ–≥–æ AR —Ç–µ—Å—Ç–∞...');
            
            try {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É WebXR AR
                if (!navigator.xr) {
                    throw new Error('WebXR –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è');
                }
                
                const isSupported = await navigator.xr.isSessionSupported('immersive-ar');
                if (!isSupported) {
                    throw new Error('AR –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –Ω–∞ —ç—Ç–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ');
                }
                
                addLog('‚úÖ WebXR AR –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è');
                
                // –°–æ–∑–¥–∞–µ–º —Å–µ—Å—Å–∏—é
                session = await navigator.xr.requestSession('immersive-ar', {
                    requiredFeatures: ['hit-test'],
                    optionalFeatures: ['dom-overlay'],
                    domOverlay: { root: document.body }
                });
                
                addLog('‚úÖ AR —Å–µ—Å—Å–∏—è —Å–æ–∑–¥–∞–Ω–∞');
                
                // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–µ–Ω–¥–µ—Ä–µ—Ä–∞
                const canvas = document.createElement('canvas');
                const gl = canvas.getContext('webgl', { xrCompatible: true });
                
                renderer = new THREE.WebGLRenderer({
                    canvas: canvas,
                    context: gl,
                    alpha: true,
                    antialias: true
                });
                
                renderer.xr.enabled = true;
                renderer.xr.setSession(session);
                renderer.setPixelRatio(window.devicePixelRatio);
                
                const baseLayer = new XRWebGLLayer(session, gl);
                await session.updateRenderState({ baseLayer: baseLayer });
                
                addLog('‚úÖ –†–µ–Ω–¥–µ—Ä–µ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–Ω');
                
                // –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ü–µ–Ω—ã
                scene = new THREE.Scene();
                camera = new THREE.PerspectiveCamera();
                
                // –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–û–ï –æ—Å–≤–µ—â–µ–Ω–∏–µ
                const ambientLight = new THREE.AmbientLight(0xffffff, 2.0);
                scene.add(ambientLight);
                
                const directionalLight = new THREE.DirectionalLight(0xffffff, 3.0);
                directionalLight.position.set(1, 1, 1);
                scene.add(directionalLight);
                
                addLog('‚úÖ –°—Ü–µ–Ω–∞ —Å–æ–∑–¥–∞–Ω–∞');
                
                // –°–û–ó–î–ê–ï–ú –ü–†–û–°–¢–û–ï –ö–†–ï–°–õ–û –ò–ó –ì–ï–û–ú–ï–¢–†–ò–ò
                createSimpleChair();
                
                // –ó–∞–ø—É—Å–∫ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞
                session.requestAnimationFrame(onXRFrame);
                
                startBtn.innerHTML = '‚úÖ –ü–†–û–°–¢–û–ï –ö–†–ï–°–õ–û –ê–ö–¢–ò–í–ù–û';
                addLog('üéâ –ü—Ä–æ—Å—Ç–æ–µ –∫—Ä–µ—Å–ª–æ –∑–∞–ø—É—â–µ–Ω–æ!');
                addLog('üëÄ –ò—â–∏—Ç–µ –ë–û–õ–¨–®–û–ï –ö–†–ê–°–ù–û–ï –∫—Ä–µ—Å–ª–æ –ø—Ä—è–º–æ –ø–µ—Ä–µ–¥ –≤–∞–º–∏!');
                
            } catch (error) {
                addLog('‚ùå –û–®–ò–ë–ö–ê: ' + error.message);
                startBtn.disabled = false;
                startBtn.innerHTML = 'üöÄ –ó–ê–ü–£–°–¢–ò–¢–¨ –ü–†–û–°–¢–û–ï –ö–†–ï–°–õ–û';
            }
        });
        
        function createSimpleChair() {
            addLog('ü™ë –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ–≥–æ –∫—Ä–µ—Å–ª–∞...');
            
            const chairGroup = new THREE.Group();
            
            // –ë–û–õ–¨–®–û–ï –°–ò–î–ï–ù–¨–ï (–∫—Ä–∞—Å–Ω–æ–µ)
            const seatGeometry = new THREE.BoxGeometry(1.5, 0.2, 1.5);
            const seatMaterial = new THREE.MeshBasicMaterial({ 
                color: 0xFF0000,  // –Ø–†–ö–û-–ö–†–ê–°–ù–´–ô
                emissive: 0x330000,
                emissiveIntensity: 0.5
            });
            const seat = new THREE.Mesh(seatGeometry, seatMaterial);
            seat.position.y = 0.4;
            chairGroup.add(seat);
            
            // –ë–û–õ–¨–®–ê–Ø –°–ü–ò–ù–ö–ê (–∫—Ä–∞—Å–Ω–∞—è)
            const backGeometry = new THREE.BoxGeometry(1.5, 1.2, 0.2);
            const backMaterial = new THREE.MeshBasicMaterial({ 
                color: 0xFF0000,  // –Ø–†–ö–û-–ö–†–ê–°–ù–´–ô
                emissive: 0x330000,
                emissiveIntensity: 0.5
            });
            const back = new THREE.Mesh(backGeometry, backMaterial);
            back.position.set(0, 1.0, -0.65);
            chairGroup.add(back);
            
            // –ë–û–õ–¨–®–ò–ï –ù–û–ñ–ö–ò (–∫—Ä–∞—Å–Ω—ã–µ)
            const legGeometry = new THREE.CylinderGeometry(0.08, 0.08, 0.4);
            const legMaterial = new THREE.MeshBasicMaterial({ 
                color: 0xFF0000,  // –Ø–†–ö–û-–ö–†–ê–°–ù–´–ô
                emissive: 0x330000,
                emissiveIntensity: 0.5
            });
            
            // 4 –Ω–æ–∂–∫–∏
            const legPositions = [
                [-0.6, 0.2, -0.6],
                [0.6, 0.2, -0.6],
                [-0.6, 0.2, 0.6],
                [0.6, 0.2, 0.6]
            ];
            
            legPositions.forEach(pos => {
                const leg = new THREE.Mesh(legGeometry, legMaterial);
                leg.position.set(...pos);
                chairGroup.add(leg);
            });
            
            // –†–ê–ó–ú–ï–©–ê–ï–ú –ö–†–ï–°–õ–û –ü–†–Ø–ú–û –ü–ï–†–ï–î –ö–ê–ú–ï–†–û–ô
            chairGroup.position.set(0, 0, -2); // 2 –º–µ—Ç—Ä–∞ –≤–ø–µ—Ä–µ–¥
            chairGroup.scale.set(1.5, 1.5, 1.5); // –£–í–ï–õ–ò–ß–ò–í–ê–ï–ú –í 1.5 –†–ê–ó–ê
            
            scene.add(chairGroup);
            chair = chairGroup;
            
            addLog('‚úÖ –ü—Ä–æ—Å—Ç–æ–µ –∫—Ä–µ—Å–ª–æ —Å–æ–∑–¥–∞–Ω–æ –∏ —Ä–∞–∑–º–µ—â–µ–Ω–æ!');
            addLog('üìç –ü–æ–∑–∏—Ü–∏—è: (0, 0, -2) - –ø—Ä—è–º–æ –ø–µ—Ä–µ–¥ –∫–∞–º–µ—Ä–æ–π');
            addLog('üé® –¶–≤–µ—Ç: –Ø–†–ö–û-–ö–†–ê–°–ù–´–ô —Å —Å–≤–µ—á–µ–Ω–∏–µ–º');
            addLog('üìè –†–∞–∑–º–µ—Ä: —É–≤–µ–ª–∏—á–µ–Ω –≤ 1.5 —Ä–∞–∑–∞');
        }
        
        function onXRFrame(time, frame) {
            session.requestAnimationFrame(onXRFrame);
            frameCount++;
            
            // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 –∫–∞–¥—Ä–æ–≤
            if (frameCount % 30 === 0) {
                addLog(`üîÑ Frame ${frameCount} - —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –∫—Ä–µ—Å–ª–∞`);
                
                if (chair && chair.position) {
                    const pos = chair.position;
                    addLog(`üìç –ö—Ä–µ—Å–ª–æ: (${pos.x.toFixed(1)}, ${pos.y.toFixed(1)}, ${pos.z.toFixed(1)})`);
                }
            }
            
            // –ü–†–û–°–¢–ê–Ø –ê–ù–ò–ú–ê–¶–ò–Ø - –≤—Ä–∞—â–µ–Ω–∏–µ –∫—Ä–µ—Å–ª–∞
            if (chair && chair.rotation) {
                chair.rotation.y = time * 0.001; // –ú–µ–¥–ª–µ–Ω–Ω–æ–µ –≤—Ä–∞—â–µ–Ω–∏–µ
            }
            
            try {
                renderer.render(scene, camera);
            } catch (error) {
                if (frameCount < 5) {
                    addLog('‚ùå –û–®–ò–ë–ö–ê –†–ï–ù–î–ï–†–ò–ù–ì–ê: ' + error.message);
                }
            }
        }
    </script>
</body>
</html> 