<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîß WebXR + Polyfill Test</title>
    <meta http-equiv="cache-control" content="no-cache, no-store, must-revalidate">
    
    <!-- WebXR Polyfill - –¥–æ–±–∞–≤–ª—è–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫—É WebXR –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç -->
    <script src="https://cdn.jsdelivr.net/npm/webxr-polyfill@latest/build/webxr-polyfill.min.js"></script>
    
    <style>
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .container {
            background: rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
            max-width: 400px;
            margin: 0 auto;
        }
        
        .test-btn {
            background: linear-gradient(45deg, #4CAF50, #8BC34A);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 16px;
            font-weight: bold;
            border-radius: 10px;
            margin: 10px 0;
            cursor: pointer;
            width: 100%;
        }
        
        .log {
            background: rgba(0,0,0,0.3);
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: left;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .status {
            font-size: 18px;
            margin: 10px 0;
        }
        
        .success { color: #4CAF50; }
        .error { color: #ff6b6b; }
        .warning { color: #ffa726; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîß WebXR Polyfill Test</h1>
        <p>–ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–±–æ—Ç—É WebXR —Å Polyfill</p>
        
        <div id="status" class="status">‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞...</div>
        
        <button id="test-btn" class="test-btn" style="display: none;">
            üöÄ –¢–ï–°–¢ WebXR + Polyfill
        </button>
        
        <div id="log" class="log">
            üìù –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è...<br>
        </div>
    </div>

    <script>
        const log = document.getElementById('log');
        const status = document.getElementById('status');
        const testBtn = document.getElementById('test-btn');
        
        function addLog(message) {
            console.log(message);
            log.innerHTML += message + '<br>';
            log.scrollTop = log.scrollHeight;
        }
        
        function updateStatus(message, type = 'normal') {
            status.innerHTML = message;
            status.className = 'status ' + type;
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è WebXR Polyfill
        addLog('üîß –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è WebXR Polyfill...');
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ polyfill
        window.addEventListener('load', async function() {
            addLog('üì± User Agent: ' + navigator.userAgent);
            addLog('üåê URL: ' + window.location.href);
            addLog('üîí HTTPS: ' + (location.protocol === 'https:' ? '–î–∞ ‚úÖ' : '–ù–µ—Ç ‚ùå'));
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ WebXR –¥–æ polyfill
            addLog('üìã –ü—Ä–æ–≤–µ—Ä–∫–∞ WebXR API:');
            
            if (window.WebXRPolyfill) {
                addLog('‚úÖ WebXR Polyfill –∑–∞–≥—Ä—É–∂–µ–Ω');
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º polyfill
                const polyfill = new WebXRPolyfill();
                addLog('üîß WebXR Polyfill –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —Ç–µ–ø–µ—Ä—å –¥–æ—Å—Ç—É–ø–Ω–æ
                if (navigator.xr) {
                    addLog('‚úÖ navigator.xr —Ç–µ–ø–µ—Ä—å –¥–æ—Å—Ç—É–ø–µ–Ω!');
                    updateStatus('üéâ WebXR –¥–æ—Å—Ç—É–ø–µ–Ω —Å Polyfill!', 'success');
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É AR
                    try {
                        const arSupported = await navigator.xr.isSessionSupported('immersive-ar');
                        addLog('ü§ñ AR –ø–æ–¥–¥–µ—Ä–∂–∫–∞: ' + (arSupported ? '‚úÖ –î–∞' : '‚ùå –ù–µ—Ç'));
                        
                        if (arSupported) {
                            updateStatus('üöÄ AR –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!', 'success');
                            testBtn.style.display = 'block';
                        } else {
                            updateStatus('‚ö†Ô∏è AR –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è', 'warning');
                            addLog('üí° –í–æ–∑–º–æ–∂–Ω–æ –Ω—É–∂–Ω–æ –≤–∫–ª—é—á–∏—Ç—å —Ñ–ª–∞–≥–∏ WebXR –≤ chrome://flags/');
                        }
                    } catch (error) {
                        addLog('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ AR: ' + error.message);
                        updateStatus('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ AR', 'error');
                    }
                    
                } else {
                    addLog('‚ùå navigator.xr –≤—Å—ë –µ—â—ë –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω');
                    updateStatus('‚ùå WebXR –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –¥–∞–∂–µ —Å Polyfill', 'error');
                }
                
            } else {
                addLog('‚ùå WebXR Polyfill –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è');
                updateStatus('‚ùå Polyfill –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è', 'error');
            }
        });
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ —Ç–µ—Å—Ç–∞
        testBtn.addEventListener('click', async function() {
            addLog('üöÄ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤–æ–π AR —Å–µ—Å—Å–∏–∏...');
            
            try {
                const session = await navigator.xr.requestSession('immersive-ar', {
                    requiredFeatures: ['local'],
                    optionalFeatures: ['hit-test']
                });
                
                addLog('‚úÖ AR —Å–µ—Å—Å–∏—è —Å–æ–∑–¥–∞–Ω–∞ —É—Å–ø–µ—à–Ω–æ!');
                updateStatus('üéâ WebXR AR —Ä–∞–±–æ—Ç–∞–µ—Ç!', 'success');
                
                // –ó–∞–∫—Ä—ã–≤–∞–µ–º —Å–µ—Å—Å–∏—é —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
                setTimeout(() => {
                    session.end();
                    addLog('üîö –¢–µ—Å—Ç–æ–≤–∞—è —Å–µ—Å—Å–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞');
                }, 3000);
                
            } catch (error) {
                addLog('‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è AR —Å–µ—Å—Å–∏–∏: ' + error.message);
                updateStatus('‚ùå AR —Å–µ—Å—Å–∏—è –Ω–µ —Å–æ–∑–¥–∞–Ω–∞', 'error');
            }
        });
    </script>
</body>
</html>